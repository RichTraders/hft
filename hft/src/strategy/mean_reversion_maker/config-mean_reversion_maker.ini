[strategy]
algorithm = maker

# =========================================
# Position Mode
# =========================================
allow_simultaneous_positions = false

# =========================================
# Dynamic Wall Threshold (Hybrid Mode)
# =========================================
# Volume-based component (EMA of trade volume)
# Alpha: 0.02 ≈ ~50 trades memory, 0.05 ≈ ~20 trades memory
wall_volume_ema_alpha = 0.03
wall_volume_multiplier = 4.0
wall_volume_min_samples = 20

# Orderbook-based component (top levels analysis)
wall_orderbook_top_levels = 20
wall_orderbook_multiplier = 3.0
wall_orderbook_percentile = 80

# Hybrid weights (must sum to 1.0)
wall_volume_weight = 0.7
wall_orderbook_weight = 0.3

# Minimum wall quantity (BTC) - auto-scales with price
# Example: 3.5 BTC × $87.5k = $306k, 3.5 BTC × $100k = $350k
wall_min_quantity = 3.5

# =========================================
# Wall Detection
# =========================================
# Maximum distance to detect wall (0.15% = ~$131 at $87.5k)
wall_max_distance_pct = 0.0015

# Maximum levels to explore
wall_max_levels = 100

# =========================================
# Defense Validation
# =========================================
# Remaining quantity must be >= trade qty × multiplier
defense_qty_multiplier = 2.0

# =========================================
# Robust Z-score Parameters (Volatility-Adaptive)
# =========================================
# Window size: recent N ticks for median/MAD calculation
zscore_window_size = 30

# Minimum samples required before calculating Z-score
zscore_min_samples = 20

# Entry threshold: ±2.5σ (oversold/overbought detection)
# Robust Z-score uses Median+MAD instead of Mean+StdDev
# This makes it resistant to fat-tail distributions and outliers
zscore_entry_threshold = 2.5

# =========================================
# Trend Acceleration Filter (Safety)
# =========================================
trend_filter_enabled = true            # Block entry during strong trends

# Number of recent ticks to analyze
trend_lookback_ticks = 5

# Minimum consecutive same-direction ticks (4/5 = 80%)
trend_consecutive_threshold = 4

# Volume acceleration multiplier (recent vs previous)
# If recent 2-tick avg volume > previous 3-tick avg × 1.5, flag as accelerating
trend_volume_multiplier = 1.5

# =========================================
# Entry Conditions (Common)
# =========================================
# OBI (Orderbook Imbalance) threshold: ±0.25 = 25% dominance
entry_obi_threshold = 0.25

# OBI calculation depth (top N levels)
entry_obi_levels = 5

# Price discount/premium threshold (0.02% = 2bps)
# Only used when use_robust_zscore = false (legacy mode)
entry_discount_threshold_pct = 0.0002

# Position size (BTC)
position_size = 0.01

# Maker order offset (0.5 tick)
entry_safety_margin = 0.00005

# Minimum spread filter (0.04% = 4bps, covers round-trip fees)
# Binance VIP0: Maker 0.02% + Taker 0.05% = ~0.04% min required
min_spread_filter = 0.0004

# =========================================
# Exit Strategy (Stop Loss)
# =========================================
# Wall amount decay threshold (exit if wall drops below 50%)
wall_amount_decay_ratio = 0.5

# Wall distance expand threshold (exit if wall moves 1.2x further)
wall_distance_expand_ratio = 1.2

# Maximum loss percentage (0.2%)
max_loss_pct = 0.002

# Stop loss mode: taker (immediate), aggressive_maker, maker
stop_loss_mode = taker

# =========================================
# Debugging & Logging
# =========================================
log_wall_detection = true
log_defense_check = true
log_entry_exit = true
